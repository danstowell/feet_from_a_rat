

import json, glob, os
import cPickle as pickle


htmloutfolder = 'html'


uktight = [[-5.7295933158306935,50.08998897041566], [-5.12017622708401,50.016160095838636], [-4.648740365978085,50.33281882213616], [-4.188802940508891,50.35483300593831], [-3.6828717724927764,50.22995101221856], [-3.441404624121448,50.63279669606179], [-2.877981277921684,50.756619686658574], [-2.4870344662728683,50.61091164152621], [-1.9811032982567536,50.59631594663514], [-1.8661189418894548,50.72023508989019], [-1.613153357881397,50.73479232077228], [-1.268200288779501,50.80024389464425], [-0.785265992036846,50.72751427073254], [-0.22184264583708183,50.829304094841135], [0.25744008618074893,50.72185840128629], [0.57154941309728,50.88011594318795], [1.0084899672930154,50.930872442813175], [1.0429852742032049,51.068361244830434], [1.4224336502152912,51.140560186321004], [1.4569289571254809,51.40671650019836], [1.0003007462185367,51.36986371516842], [0.6591562254005955,51.49646186953679], [0.9451856800698224,51.56273251031443], [0.9853528920428927,51.74023016855822], [1.2922364363553405,51.81771332750149], [1.294316520890105,51.961214587654744], [1.635802636984394,52.151192301399966], [1.7552794870745665,52.40985399339026], [1.7211020151032517,52.71749714850607], [1.4731902007490183,52.88342407087044], [1.0503978665370433,52.961854335910864], [0.5300380705838426,52.961854335910864], [0.36742563434846726,52.78518635944779], [0.02593951825417954,52.9422600881128], [0.38368687797200485,53.157308915822945], [0.28611941623078013,53.283879240503325], [0.13976822361894248,53.46819439815347], [-0.08788918711058286,53.574538838955455], [0.09098449274832955,53.651712654867275], [-0.2342403797224205,53.939859648718866], [-0.2342403797224205,54.07365145487604], [-0.12041167435765814,54.11179871616774], [-0.3656437181586136,54.26520331041868], [-0.593984319440831,54.506585511625346], [-1.1286087790169836,54.62336067073193], [-1.3074824588758966,54.792467670850215], [-1.3725274333700468,54.951533028928125], [-1.5059273518068248,55.1420403152713], [-1.6001848440995714,55.36032293434855], [-1.6489685749701841,55.58153664989518], [-1.8766259856997092,55.69167845897602], [-2.1530671272998467,55.89280182467322], [-2.5108144870176727,55.97478048585946], [-2.754733141370735,56.056585782682504], [-3.014913039347335,55.95657799473101], [-3.5677953225476107,56.01115978668822], [-3.1775254755827107,56.083815724118914], [-2.949868064853185,56.21063460131622], [-2.8035168722413473,56.18349435017312], [-2.575859461511822,56.2919401958757], [-2.8035168722413473,56.34604803508195], [-2.8035168722413473,56.4720017125227], [-2.46203075614706,56.63333026140525], [-2.413247025276447,56.740500941597155], [-2.1855896145469225,56.95392847704977], [-2.0392384219350848,57.21900461489495], [-1.7953197675820223,57.473447542773194], [-1.811581011205559,57.63049214712274], [-2.0880221528056975,57.68269000542421], [-2.5035113575680232,57.682170473061205], [-2.9173455776061097,57.70876078158288], [-3.0799580138414853,57.64789977764834], [-3.3076154245710105,57.71744687148885], [-3.498616482614492,57.71186524392763], [-3.632840297041761,57.639197005688295], [-3.8279752205242112,57.569499687082995], [-4.071893874877274,57.569499687082995], [-4.210258747486771,57.507699338275565], [-3.7466690024065232,57.84748831983665], [-4.1694613366184985,57.80419320533046], [-4.006848900383123,57.89073144969813], [-3.9905876567595864,57.985683535905835], [-3.8442364641477482,58.01153597716346], [-3.4539666171828483,58.243369120165035], [-3.082926388013617,58.36472191374789], [-3.0089232993455792,58.6490424045852], [-3.486489104429923,58.6094789839678], [-3.815707136901844,58.58631924943911], [-4.016437213452212,58.59393139952642], [-4.367223038996735,58.5534421465161], [-5.015046005042449,58.61794792617027], [-5.161397197654287,58.4651927499131], [-5.161397197654287,58.25192658058761], [-5.324009633889662,58.25192658058761], [-5.324009633889662,58.0459768695453], [-5.26164442994879,57.94240145679398], [-5.844080826224009,57.87256031640304], [-5.848362589844035,57.617691177157404], [-5.811846942595787,57.32450521824789], [-6.006981866078237,57.30694277113583], [-6.169594302313613,57.53460090142192], [-6.169594302313613,57.62178520165239], [-6.348467982172525,57.67399557689054], [-6.429774200290213,57.50840486623294], [-6.592386636525588,57.57821916026101], [-6.787521560008038,57.41219166283821], [-6.1370718150665375,57.14850284404141], [-6.039504353325313,57.060186327130836], [-5.746801968101638,57.166140899961015], [-5.8606306734664,56.882921175162714], [-6.189677908300148,56.766806989540875], [-6.247078158068304,56.70806363266244], [-6.029126866388549,56.63862605667742], [-5.931494590324133,56.53506912229241], [-5.811882735790852,56.52751345173087], [-5.645736540811335,56.470071778045494], [-5.226442172148437,56.731581699062104], [-5.698018237231025,56.30998466178401], [-5.730540724478099,56.09288809689006], [-5.624842640925107,56.05204558870933], [-5.689887615419256,55.838052971926736], [-5.616712019113337,55.72374484858817], [-5.738671346289869,55.49872696017821], [-5.754932589913406,55.415742769095395], [-5.819977564407556,55.323333215200016], [-5.616712019113337,55.323333215200016], [-5.486622070125037,55.3880425605503], [-5.559797666430956,55.44342356711603], [-5.445968961066193,55.632056750387505], [-5.445968961066193,55.75120938412752], [-5.3402708775132,55.79236995963536], [-5.454099582877962,55.997521560829604], [-5.3890546083838125,55.997521560829604], [-5.299617768454356,55.84261832405411], [-5.039437870477756,55.72832361334246], [-5.047568492289525,55.883682374374125], [-4.876825434242381,56.01115978668823], [-4.893086677865918,55.70542441978933], [-4.6654292671363935,55.55855145113109], [-4.657298645324624,55.43881144842927], [-4.844302946995306,55.36032293434856], [-4.8605641906188435,55.20751758216181], [-5.104482844971906,55.02150950324578], [-5.185789063089594,55.00286103754394], [-5.202050306713131,54.90948856832457], [-5.071960357724831,54.80652810483274], [-4.950001030548301,54.65159414964104], [-4.876825434242381,54.68920829953774], [-4.958131652360068,54.8299512934576], [-4.868694812430612,54.8767569299341], [-4.397118747348024,54.67980802795246], [-4.372726881912718,54.8767569299341], [-4.145069471183192,54.76433212707946], [-3.933673304077205,54.78777977253144], [-3.6978852715359114,54.853360900501556], [-3.3238766681945484,54.95153302892814], [-3.6328402970417617,54.533825268010574], [-3.2019173410180173,54.05456466845498], [-3.0555661484061796,54.14991090818365], [-2.8360393594884235,54.126094897028814], [-2.9254761994178793,53.95421506223443], [-3.0474355265944113,53.906344466405564], [-3.0555661484061796,53.74798165646334], [-2.8279087376766547,53.74798165646334], [-3.0393049047826426,53.666167044446], [-3.096219257465023,53.57453883895547], [-3.031174282970873,53.443987966592715], [-3.3238766681945484,53.35673052076977], [-3.6653627842888366,53.283879240503325], [-3.8767589513948235,53.31303467675205], [-4.088155118500812,53.2498394056084], [-4.348335016477411,53.12316836209487], [-4.3320737728538745,53.045030886099156], [-4.795519216124694,52.809766618528045], [-4.177591958430267,52.92265696249057], [-4.063763253065505,52.47428364787017], [-4.1369388493714245,52.31551801832961], [-4.4459024782186365,52.166156145012984], [-4.81991108156,52.041303676858604], [-5.324009633889662,51.896036657713395], [-5.1126134667836745,51.83076404401603], [-5.1126134667836745,51.785519818096134], [-5.234572793960206,51.73519518059776], [-4.950001030548299,51.599038362132106], [-4.697951754383468,51.65960302530233], [-4.697951754383468,51.745264595519885], [-4.405249369159793,51.720086850487306], [-4.275159420171493,51.60408850594314], [-4.250767554736186,51.533335373568235], [-3.8523670859595174,51.60408850594314], [-3.6409709188535295,51.46247209798354], [-3.388921642688698,51.396571806825136], [-3.1450029883356354,51.43206838981677], [-2.9661293084767224,51.52321879341975], [-2.4132470252764473,51.77042831617402], [-2.72221065412366,51.502978888921945], [-2.9092149557943414,51.416858943466124], [-3.0474355265944104,51.22376757881605], [-3.356399155441623,51.18301315307836], [-3.535272835300536,51.218675247492385], [-4.242636932924418,51.177916314305044], [-4.242636932924418,51.06053344389828], [-4.348335016477411,50.99405463775016], [-4.543469939959862,51.01451981043379], [-4.543469939959862,50.76319897246804], [-4.795519216124693,50.61381892014382], [-5.006915383230679,50.54153412150611], [-5.039437870477756,50.43807762471646], [-5.234572793960205,50.28766314353049], [-5.567928288242724,50.20967543875325], [-5.7295933158306935,50.08998897041566]]


def decidearticle(string):
	if string[0] in "aeiuoAEIOU":
		return "an"
	else:
		return "a"

def loadspecs(picklestoo=False):
	"Returns a dict of the specfile data. If picklestoo=True then it appends cached proximity data too."
	specs = {}
	for specfile in glob.glob("specs/*.json"):
		lbl = os.path.splitext(os.path.basename(specfile))[0]
		with open(specfile, 'rb') as fp:
			spec = json.load(fp)
		if 'readable' not in spec:
			spec['readable'] = lbl
		spec['article'] = decidearticle(spec['readable'])
		if picklestoo:
			with open('data_pickles/type_%s.pickle' % lbl, 'rb') as fp:
				extradata = pickle.load(fp)
			for key, val in extradata.items():
				spec[key] = val

		specs[lbl] = spec
	return specs

def construct_html_sentence(spec):
	return "In mainland Britain, you are never more than %i miles from %s %s." \
			% (spec['distancekm'] / 1.609344, spec['article'], spec['readable'])



###############################################
if __name__ == '__main__':
	specs = loadspecs(picklestoo=True)
	#for specname, spec in specs.items():
	#	print specname
	#	print spec
	for specname, spec in specs.items():
		print construct_html_sentence(spec)

